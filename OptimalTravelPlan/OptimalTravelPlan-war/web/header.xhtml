<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"> 

    <h:graphicImage library="images" name="OTP_Logo-Cropped.jpg" width="150px" height="95px" />&nbsp;
    <h3 style="padding: 10px; display:inline; width:600px; height: 40px; position: relative;">Welcome to Optimal Travel Plans!</h3>

    <h:form>
        <h:panelGroup style="right:10px ; top:30px; position: absolute; width:400px; height: 45px;" rendered="#{sessionScope.isLogin == true}">
            <h:outputText value="You are login as #{sessionScope.loggedInAccount.username}" />
            <p:menubar>
                <p:submenu label="Account action" icon="pi pi-bars">
                    <p:menuitem value="View/Update account details" 
                                actionListener="#{loginManagedBean.updateAccount}"
                                update="formUpdateAccount" 
                                ajax="true"
                                oncomplete="PF('dialogUpdateAccount').show();"
                                icon="pi pi-refresh">

                    </p:menuitem>
                    <p:menuitem value="Logout" action="#{loginManagedBean.logout}" 
                                icon="pi pi-external-link"/>
                </p:submenu>
            </p:menubar>
        </h:panelGroup>
    </h:form>

    <h:form id="formUpdateAccount">
        <p:dialog id="dialogUpdateAccount" widgetVar="dialogUpdateAccount" header="Update Account" closable="true">
            <p:messages id="messagesUpdateAccount" redisplay="false" />
            <p:panelGrid rendered="#{loginManagedBean.admin != null}">

                <p:row>
                    <p:column>
                        <h:outputLabel value="Staff ID: " />
                    </p:column>
                    <p:column>
                        <h:outputText value="#{loginManagedBean.admin.accountId}" />
                    </p:column>
                    <p:column>
                        &nbsp;
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="adminUsername" value="Username: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="adminUsername" value="#{loginManagedBean.admin.username}" placeholder="#{loginManagedBean.admin.username}" required="true" requiredMessage="Username is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="adminUsername"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="adminPassword" value="Password: " />
                    </p:column>
                    <p:column>
                        <p:password id="adminPassword" value="#{loginManagedBean.password}" required="false" feedback="true" redisplay="true"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="oldPassword" value="Old Password: " />
                    </p:column>
                    <p:column>
                        <p:password id="oldPassword" value="#{loginManagedBean.oldPassword}" required="false" feedback="true" redisplay="true"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column colspan="3">
                        <p:commandButton value="Update Details" update="formUpdateAccount" actionListener="#{loginManagedBean.doUpdateAction}" oncomplete="PF('dialogUpdateAccount').show();" />
                    </p:column>
                </p:row>

            </p:panelGrid>

            <p:panelGrid rendered="#{loginManagedBean.business != null}">

                <p:row>
                    <p:column>
                        <h:outputLabel value="Business ID: " />
                    </p:column>
                    <p:column>
                        <h:outputText value="#{loginManagedBean.business.accountId}" />
                    </p:column>
                    <p:column>
                        &nbsp;
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="username" value="Username: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="username" value="#{loginManagedBean.business.username}" placeholder="#{loginManagedBean.business.username}" required="true" requiredMessage="Username is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="username"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="password" value="Password: " />
                    </p:column>
                    <p:column>
                        <p:password id="password" value="#{loginManagedBean.password2}" required="false" feedback="true" redisplay="true"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="oldPassword2" value="Old Password: " />
                    </p:column>
                    <p:column>
                        <p:password id="oldPassword2" value="#{loginManagedBean.oldPassword2}" required="false" feedback="true" redisplay="true"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="companyName" value="Company name: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="companyName" value="#{loginManagedBean.business.companyName}" placeholder="#{loginManagedBean.business.companyName}" required="true" requiredMessage="Company name is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="companyName"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="website" value="Website URL: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="website" value="#{loginManagedBean.business.companyWebsite}" placeholder="#{loginManagedBean.business.companyNumber}" required="true" requiredMessage="Website is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="website"/>
                    </p:column>
                </p:row>


                <p:row>
                    <p:column>
                        <h:outputLabel for="companyNumber" value="Company Contact: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="companyNumber" value="#{loginManagedBean.business.companyNumber}" placeholder="#{loginManagedBean.business.companyNumber}" required="true" requiredMessage="Company Number is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="companyNumber"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column>
                        <h:outputLabel for="headquarterAddress" value="Headquarter Address: " />
                    </p:column>
                    <p:column>
                        <p:inputText id="headquarterAddress" value="#{loginManagedBean.business.headquarterAddress}" placeholder="#{loginManagedBean.business.headquarterAddress}" required="true" requiredMessage="Headquarter Address is required"/>
                    </p:column>
                    <p:column>
                        <p:message for="headquarterAddress"/>
                    </p:column>
                </p:row>

                <p:row>
                    <p:column colspan="3">
                        <p:commandButton value="Update Details" update="formUpdateAccount" actionListener="#{loginManagedBean.doUpdateAction}" oncomplete="PF('dialogUpdateAccount').show();" />
                    </p:column>
                </p:row>

            </p:panelGrid>
        </p:dialog>
    </h:form>


</ui:composition>

